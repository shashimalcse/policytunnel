<!DOCTYPE html>
<html lang="en">
<head>
<script type="module">
import { validateTunnelPolicy } from "./build/release.js";
const jsonString = `
[
  [
    {
      "attribute": {
        "name": "authn_ctx.groups",
        "type": "array"
      },
      "operator": "contains",
      "value": ["shasimal"]
    },
    {
      "attribute": {
        "name": "authn_ctx.sub",
        "type": "string"
      },
      "operator": "equal",
      "value": "shashimal"
    }
  ],
  [
    {
      "attribute": {
        "name": "authn_ctx.groups",
        "type": "array"
      },
      "operator": "not_contains",
      "value": ["shasimal"]
    }
  ]
]
`;

const input  = `
{
    "authn_ctx": {
        "scp": [
            "openid",
            "profile",
            "email",
            "sample_service:read"
        ],
        "sub": "joe",
        "idp_id": "4abc18656e1d79589b6a6ba8afcb350a02623c6f5d39f43c3bcc47b697e92538",
        "groups": [
            "admins",
            "users"
        ],
        "email": "testjoe@cloudentity.com",
        "email_verified": true,
        "phone_number": "+1-555-6616-899",
        "phone_number_verified": "+1-555-6616-899",
        "address": {
            "formatted": "",
            "street_address": "1463  Perry Street",
            "locality": "Dayton",
            "region": "Kentucky",
            "country": "US",
            "postal_code": "41074"
        },
        "name": "Joe Test",
        "given_name": "Joe",
        "middle_name": "",
        "family_name": "Test",
        "nickname": "joe",
        "preferred_username": "testjoe",
        "profile": "",
        "picture": "",
        "website": "",
        "gender": "male",
        "birthdate": "1960-10-09",
        "zoneinfo": "",
        "locale": "",
        "updated_at": ""
    },
    "contexts": {
        "scopes": {
            "users.*": [
                {
                    "params": [
                        "joe"
                    ],
                    "requested_name": "users.joe"
                }
            ]
        },
        "workspaceMetadata": {
            "sap_id": "123456789"
        }
    },
    "request": {
        "headers": {
            "Content-Type": [
                "application/json"
            ],
            "X-Custom-Header": [
                "BOT_DETECTED"
            ]
        },
        "method": "POST",
        "path_params": {
            "users": "admins"
        },
        "query_params": {
            "limit": [
                "1000"
            ],
            "offset": [
                "100"
            ]
        },
        "path": "/doawesomethings"
    }
}

`
document.body.innerText = validateTunnelPolicy(jsonString, input);
</script>
</head>
<body></body>
</html>
